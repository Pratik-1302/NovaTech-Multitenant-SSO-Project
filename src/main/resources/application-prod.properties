# =============================================================================
# NovaTech SSO Management System - PRODUCTION Configuration
# =============================================================================
# This configuration is activated when SPRING_PROFILES_ACTIVE=prod
# All sensitive data MUST be provided via environment variables
# =============================================================================

# =============================================================================
# Server Configuration
# =============================================================================
server.port=${PORT:8080}

# Force HTTPS in production (Render provides this automatically)
server.forward-headers-strategy=native

# =============================================================================
# Database Configuration (Render PostgreSQL)
# =============================================================================
# Render automatically provides DATABASE_URL in the format:
# postgres://user:password@host:port/database
# Spring Boot requires 'postgresql' instead of 'postgres' in the URL
spring.datasource.url=${DATABASE_URL}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA/Hibernate Configuration - PRODUCTION
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.jdbc.time_zone=UTC
spring.jpa.properties.hibernate.enable_lazy_load_no_trans=false

# Production Database Connection Pool
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.leak-detection-threshold=60000

# =============================================================================
# Security Configuration - PRODUCTION
# =============================================================================
# Secure session cookies (HTTPS only)
server.servlet.session.timeout=30m
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.secure=true
server.servlet.session.cookie.same-site=strict

# =============================================================================
# Logging Configuration - PRODUCTION
# =============================================================================
# Minimal logging in production for performance
logging.level.root=WARN
logging.level.com.novatech.service_app=INFO
logging.level.org.springframework.security=WARN
logging.level.org.hibernate.SQL=WARN
logging.level.org.springframework.web=WARN

# Log pattern for production (includes timestamps)
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# =============================================================================
# Thymeleaf Configuration - PRODUCTION
# =============================================================================
spring.thymeleaf.cache=true

# =============================================================================
# Error Handling - PRODUCTION
# =============================================================================
# Don't expose stack traces in production
server.error.include-message=always
server.error.include-binding-errors=never
server.error.include-stacktrace=never
server.error.include-exception=false

# =============================================================================
# Custom Domain Configuration
# =============================================================================
# Your custom domain
app.domain=${CUSTOM_DOMAIN:pratiktech.cloud}
app.base-url=https://${app.domain}

# Allowed origins for CORS (if needed for API access)
app.allowed-origins=${ALLOWED_ORIGINS:https://pratiktech.cloud,https://www.pratiktech.cloud}

# =============================================================================
# Production Optimizations
# =============================================================================
# Enable response compression
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json
server.compression.min-response-size=1024

# HTTP/2 support
server.http2.enabled=true
